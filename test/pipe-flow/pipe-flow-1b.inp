2D PIPE FLOW
------------
Simple viscous flow through a 2D pipe of length L. Constant pressure p1 at one
end, p2 at the other. No-slip BC along the walls of the pipe. Extend uniformly
in the z direction (3 cells thick) with free-slip BC on the z=const boundaries.
Solution is symmetric across the mid-plane of the pipe, so solve in one half
only with free-slip BC on the symmetry plane.

At steady state the axial velocity U is a function of the coordinate across the
width of the pipe, with U'' = (p2-p1)/(2*mu*L).

If width of the pipe is 2, -1 <= y <= 1, p1 = 3, p2 = 0, mu = 3, L = 1, then
U(y) = (1 - y^2)/2, and maximum axial velocity along axis is 1/2.

&MESH mesh_file = 'mesh1a-rotx.gen'/

&OUTPUTS
  output_t = 0.0, 1.5
  output_dt = 1.5
/

Hack to hit the final time exactly
&SIMULATION_CONTROL
  phase_start_times = 1.5
  phase_init_dt_factor = 1.0
/

&PHYSICS
  flow = .true.
/

&FLOW
  inviscid = .false.
  courant_number = 0.5
  viscous_number = 0.3333333
  viscous_implicitness = 0.5
/

&FLOW_VISCOUS_SOLVER
  rel_tol = 1.0e-10
  abs_tol = 1.0e-11
  max_ds_iter = 50
  max_amg_iter = 5
  krylov_method = 'cg'
/ 

&FLOW_PRESSURE_SOLVER
  rel_tol = 0.0
  abs_tol = 1.0e-10
  max_ds_iter = 50
  max_amg_iter = 25
  krylov_method = 'cg'
/

&NUMERICS
  dt_init = 0.001
  dt_grow = 1.1
  dt_min  = 1.0e-5
  dt_max  = 1.0
/

Inlet pressure
&FLOW_BC
  name = 'inlet'
  face_set_ids = 1
  condition = 'pressure'
  data_constant = 3.0
/

Outlet pressure
&FLOW_BC
  name = 'outlet'
  face_set_ids = 2
  condition = 'pressure'
  data_constant = 0.0
/

Pipe walls
&FLOW_BC
  name = 'wall'
  face_set_ids = 3
  condition = 'no slip'
/

Symmetry planes
&FLOW_BC
  name = 'symmetry'
  face_set_ids = 4
  condition = 'slip'
/

&BODY
  surface_name = 'from mesh file'
  mesh_material_number = 1
  material_number = 1
  velocity = 3*0.0
  temperature = 0.0
/

&MATERIAL
  material_name    = 'water'
  material_number  = 1
  density          = 1.0  ! not void
  material_feature = 'background'
/

&PHASE
  name = 'water'
  property_name(1) = 'density',       property_constant(1) = 1.0
  property_name(2) = 'specific heat', property_constant(2) = 1.0
  property_name(3) = 'viscosity',     property_constant(3) = 3.0
/

&MATERIAL_SYSTEM
  name = 'water'
  phases = 'water'
/
