STEADY INVISCID 3-MATERIAL FLOW
-------------------------------
Steady inviscid flow in a 2D square domain (1 cell thick in z) with uniform flow
directed diagonally across the mesh. Prescribed inflow velocity on the left and
bottom sides, and dirichlet pressure on the right and top (outflow) sides. One
fluid occupies half a disk, another the other half, and a third fluid the
complement. Fluid density ratio is 100. Constant initial velocity field consistent
with the BC. Velocity should remain constant.

This problem is analogous to a pure advection problem, except that instead
of a prescribed constant velocity, we solve for the velocity, expecting to
recovery that constant velocity.

&OUTPUTS
  output_t  = 0.0, 0.03125 !2.0
  output_dt = 2.0
/

A kludge to force hitting the final time exactly
&SIMULATION_CONTROL
  phase_start_times = 2.0
  phase_init_dt_factor = 1.0
/

&MESH
  mesh_file = 'mesh3a.gen'
/

&PHYSICS
  legacy_flow = .true.
/

&NUMERICS
  cycle_max = 1
  dt_constant = 0.03125
/

&LEGACY_FLOW
  inviscid = .true.
  courant_number = 0.5
  projection_linear_solution  = 'projection'
  volume_track_subcycles = 4
/

&LINEAR_SOLVER
  name                   = 'projection'
  method                 = 'fgmres'
  preconditioning_method = 'ssor'
  preconditioning_steps  = 2
  relaxation_parameter   = 1.4
  convergence_criterion  = 1.0e-10
  maximum_iterations     = 50
/

Inflow velocity at left
&BC
  surface_name = 'from mesh file'
  mesh_surface = 1
  bc_variable  = 'velocity'
  bc_type      = 'dirichlet'
  bc_value     = 4.0, 3.0, 0.0
/

Inflow velocity at bottom
&BC
  surface_name = 'from mesh file'
  mesh_surface = 3
  bc_variable  = 'velocity'
  bc_type      = 'dirichlet'
  bc_value     = 4.0, 3.0, 0.0
/

Pressure at right outflow
&BC
  surface_name = 'from mesh file'
  mesh_surface = 2
  bc_variable  = 'pressure'
  bc_type      = 'dirichlet'
  bc_value     = 0.0
/

Pressure at top outflow
&BC
  surface_name = 'from mesh file'
  mesh_surface = 4
  bc_variable  = 'pressure'
  bc_type      = 'dirichlet'
  bc_value     = 0.0
/

&BODY
  surface_name = 'cylinder'
  fill = 'outside'
  axis = 'z'
  height = 5
  radius = 8
  translation_pt = 4.0, 3.0, -2.5
  material_number = 3
  velocity = 4.0, 3.0, 0.0
  temperature = 0.0
/

&BODY
  surface_name = 'plane'
  axis = 'x'
  !rotation_angle = 0, 0, 36.8698976458440
  translation_pt = 4.0, 3.0, 0.0
  material_number = 2
  velocity = 4.0, 3.0, 0.0
  temperature = 0.0
/

&INTERFACES
  vof_method = 'divide'
  vof_tolerance = 1.0e-2
/

&BODY
  surface_name = 'background'
  material_number = 1
  velocity = 4.0, 3.0, 0.0
  temperature = 0.0
/

&MATERIAL
  priority = 3
  material_name = 'water'
  material_number = 1
  density = 1.0 ! not void
  material_feature = 'background'
 /

&PHASE
  name = 'water'
  property_name(1) = 'density', property_constant(1) = 100.0
/

&MATERIAL_SYSTEM
  name = 'water'
  phases = 'water'
/

&MATERIAL
  priority = 2
  material_name = 'oil'
  material_number = 2
  density = 1.0 ! not void
 /

&PHASE
  name = 'oil'
  property_name(1) = 'density', property_constant(1) = 100.0
/

&MATERIAL_SYSTEM
  name = 'oil'
  phases = 'oil'
/

&MATERIAL
  priority = 1
  material_name = 'air'
  material_number = 3
  density = 1.0 ! not void
 /

&PHASE
  name = 'air'
  property_name(1) = 'density', property_constant(1) = 1.0
/

&MATERIAL_SYSTEM
  name = 'air'
  phases = 'air'
/
