ANDREY'S WAVEGUIDE TEST PROBLEM

&MESH
  mesh_file = 'meshes/wg1-hex-10.gen'
/

&OUTPUTS
  output_t = 0.0, 1.0e-6
  output_dt = 1.0e-6
/

&NUMERICS /

&PHYSICS
  materials = 'dielectric', 'VOID'
  heat_transport = T
  electromagnetics = T
/

&DIFFUSION_SOLVER
  abs_temp_tol = 0
  rel_temp_tol = 1e-4
  abs_enthalpy_tol = 0
  rel_enthalpy_tol = 1e-4
  verbose_stepping = T
/


### BODIES #####################################################################

&BODY
  surface_name = 'from mesh file'
  mesh_material_number = 2
  material_name = 'dielectric'
  temperature = 300.0
/

&BODY
  surface_name = 'background'
  material_name = 'VOID'
  temperature = 300.0
/

### BOUNDARY CONDITIONS ########################################################

&THERMAL_BC
  name = 'adiabatic'
  type = 'flux'
  face_set_ids = 1, 2, 3
  !face_set_ids = 2, 3
  flux = 0.0
/


### EM HEATING #################################################################

&EM_MESH
  mesh_file = 'meshes/wg1-tet-10.gen'
/

&ELECTROMAGNETICS
  use_fd_solver = T
  !use_mixed_form = T
  fd_solver_type = 'minres'
  !fd_solver_type = 'mumps'
  fd_precon_type = 'gs' ! minres(none, gs, boomer)
  boomer_num_cycles = 1
  !boomer_interp_type = 6
  !boomer_relax_down_type = 13
  !boomer_relax_up_type = 14
  rel_tol = 1e-10
  max_iter = 100000
  print_level = 3
  graphics_output = T
  matl_change_threshold = 0.6
/

Frequency is specified here :/
&INDUCTION_SOURCE_FIELD
  !frequency = 500.0
  frequency = 2.45d9
  uniform_strength = 1
  orientation = 'z'
/

&ELECTROMAGNETIC_BC
  name = 'walls'
  type = 'pec'
  face_set_ids = 2, 3
/

! This is replaced by the following equivalent general Robin BC
!&ELECTROMAGNETIC_BC
  name = 'waveguide port'
  type = 'wg-port'
  face_set_ids = 1
/

&ELECTROMAGNETIC_BC
  name = 'waveguide port'
  type = 'robin'
  face_set_ids = 1
  alpha = (0.0, 3.623932426313112e+01)
  g_func = 'port-g'
/

&COMPLEX_VFUNCTION
  name ='port-g'
  type = 'library'
  library_path = 'libwg_modes.so'
  library_symbol = 'te01'
  dim = 3
  parameters = 8.636e-2, 3.623932426313112e+01, 1.0 ! a, h0, E0
/

### MATERIALS ##################################################################

### STUFF ###

&MATERIAL
  name = 'dielectric'
  density = 100.0
  specific_heat = 100.0
  conductivity = 1.0
  relative_permittivity = 4.0
  dielectric_loss_tangent = 0.025
/

